# 13장: 스코프

- 스코프는 유효범위를 뜻한다.
  - 선언된 위치에 따라 전역/지역으로 나뉘게 된다. (스코프는 식별자가 유효한 범위를 뜻한다.)

1. 전역
   - 코드의 가장 바깥영역에서 선언한 변수
2. 지역
   - 함수 내에서 선언된 변수(함수내에서 식별이 가능하다.)

스코프란 개념이 없다면 같은 이름을 가진 변수끼리 충돌을 일으키므로 변수이름을 하나밖에 사용하지 못한다.


- 스코프 체인: 함수의 중첩에 의해 계층적 구조를 가진다
   - 모든 지역 스코프의 최상위 스코프는 전역스코프다!
- 변수를 참조할 때 자바스크립트 엔진은 변수 참조 코드 스코프에서 상위 스코프 방향으로 선언된 변수를 검색
- 상위 스코프에서 선언한 변수는 하위스코프에서 검색가능 <==> 하위스코프(지역)에서 선언된 변수는 상위스코프에서 검색불가능

**자바스크립트 엔진은 코드를 실행하기전에 렉시컬환경(구조)을 생성한다.** <br/>
 < 스코프체인은 실행컨텍스트의 렉시컬 환경을 단방향으로 연결한것이다.> 

## 함수 레벨 스코프

- 블록 레벨 스코프: 자바,C환경은 모든 코드 블록(if, for, while...)이 만드는 지역 스코프
   - 단 es6의 let, const 키워드는  블록 레벨 스코프를 지원
- 함수 레벨 스코프: var 키워드로 선언된 변수는 오로지 함수의 코드 블록(함수 몸체)만을 지역 스코프로 인정하는 특성
```js
var x = 1;

if (true) {
    var x =10;
}
console.log(x); // 10
```
  
렉시컬 스코프 : 함수를 어디서 호출/정의 했는지 상위스코프를 결정한다.

# 14장: 전역 변수의 문제점

## 변수의 생명 주기
- 지역변수의 생명주기: 함수내부에서 선언된 지역변수는 함수가 종료되면 소멸한다.(메모리공간확보->메모리공간 해제(가용메모리 풀에 반환))
- 전역변수: 런타임 이전에 엔진에 의해 먼저 실행

### 전역 변수의 생명주기

- 전역변수는 코드가 로드되자마자 곧바로 해석되고 실행한다.
  - var 키워드로 선언한 전역 변수의 생명 주기는 전역 객체의 생명 주기와 일치한다.(더이상 실행할 문이 없을경우에 종료된다.)
    <br/><br/>
- 전역 객체: 클라이언트 사이드 환경(브라우저)에서는 window, 서버사이드환경(Node.js)에서는 global 객체를 의미이다.
<br/><br/>
- 전역 변수의 문제점
  1. 암묵적 결합: 모든 코드가 전역 변수를 참조하고 변경할 수 있음
  2. 긴 생명 주기: 변수이름 중복가능성으로 인한 재할당 문제
  3. 스코프 체인 상에서 종점에 존재: 전역변수의 검색속도 느림
  4. 네임스페이스 오염: 파일 분리되도 하나의 전역스코프를 공유

### 전역 변수의 사용을 억제하는 방법

- 즉시 실행 함수 : 한번만 사용
- 네임스페이스 객체 : 식별자 충돌 방지 (빈객체 사용으로 그떄마다 프로퍼티?를 추가)
- 모듈 패턴: 캡슐화를 통한 객체의 특정 프로퍼티를 은닉한다 이로인해 외부의 접근으로부터 내부를 보호할수 있다.


# 15장: let, const 키워드와 블록 레벨 스코프

## var 키워드로 선언한 변수의 문제점

- 변수의 중복 선언
- 함수 레벨 스코프 -> 함수 외부에서 선언하면 전역변수 되벌임,,
- 변수 호이스팅: 변수 호이스팅으로 선언문 이전에 참조 가능
    - let과 const는 안그런단 말인가? -> 호이스팅이 발생하지만 발생하지 않는 것처럼 동작할 뿐



## let 키워드

- 변수 중복 선언 금지: 중복 선언하면 Syntax Error

- 블록 레벨 스코프: 함수 포함 모든 코드 블록(if, for, while...)을 지역 스코프로 인정

- **변수 호이스팅**: 선언 단계와 초기화 단계가 분리되어 진행

    - 런타임 이전 엔진에 의해 암묵적으로 선언 단계 실행
    - 런타임에서 변수 선언문에 도달했을 때 초기화
      -> 초기화 단계 전 변수 접근하면 ReferenceError
    - 일시적 사각지대: 스코프 시작~초기화단계 시작 지점(변수 선언문)까지 변수를 참조할 수 없는 구간

  ```javascript
  let foo = 1;
  {
  	console.log(foo); // ReferenceError 지역변수 foo가 호이스팅돼 선언은 돼서 에러남. 호이스팅이 되지 않았더라면 전역변수 값인 1이 찍혔을 것이다.
  	let foo = 2;
  }
  ```

- let으로 선언한 전역 변수는 전역 객체의 프로퍼티가 아님 ex) `window.x` 로 호출 불가



## const 키워드

- 선언과 동시에 초기화 해야
- 블록 레벨 스코프, 호이스팅 발생하지 않는 것처럼 동작
- 재할당 금지
- 상수: 대문자와 언더스코어(\_)로 네이밍 ex)TAX\_RATE
- const 키워드로 선언된 객체는 재할당은 불가능하지만, 프로퍼티 변경은 가능하다



## 어떤 키워드를 사용할까

const > let(재할당이 필요한 경우) > var(사용하지 않는다)

